% Relative cheng plot
% define figure properties
opts.Colors     = get(groot,'defaultAxesColorOrder');
opts.saveFolder = 'img/';
opts.width      = 8.25*2;
opts.height     = 6.25*1.5;
opts.fontType   = 'Times New Roman';
opts.fontSize   = 9;

% create new figure
fig = figure('DefaultTextFontName', opts.fontType, 'DefaultAxesFontName', opts.fontType); clf

xy_raw = [0.9851162790697676 -0.6799260484577205
2.0120930232558143 4.383506859978593
3.0093023255813955 3.5054977133404686
3.9618604651162794 1.5186727644254159
4.973953488372093 0.797577113943758
5.97860465116279 0.4373552593169201
6.983255813953488 0.39094093607083735
8.010232558139535 0.23470857254062505
9.02232558139535 0.10984723168239885
9.989767441860467 0.0790989588401283
10.972093023255814 0.06928091855599838
11.999069767441862 0.0333414420550735
13.011162790697675 0.007852486134085623
14.01581395348837 0.003279167072101963
14.990697674418607 0.009146638123964657
15.987906976744187 0.004568453828937891
17.000000000000004 0.005230125523011608
0.9851162790697676 0.9100321105380944
1.9823255813953493 2.98181375887905
2.9795348837209303 1.6017125620317216
3.9767441860465116 0.28437287146054313
4.973953488372093 0.2431838085044271
5.956279069767442 0.07646200252992141
7.0130232558139545 0.07715286562226353
8.025116279069769 -0.047708475235963554
9.007441860465116 0.03661574389413236
9.96 0.04769874476987468
10.97953488372093 0.058825532743017384
12.013953488372094 0.028121046998150767
13.011162790697675 -0.0026077649119393698
14.02325581395349 0.00851415782816023
15.02325581395349 0.00851415782816023
15.987906976744187 -0.0006616716940737177
17.014883720930236 0.000009730466089763468
0.9851162790697676 1.2761408971489736
1.9972093023255815 1.8730368784664782
3.0093023255813955 0.022234115014109435
3.9618604651162794 0.2425221368103525
4.973953488372093 -0.687778534591807
5.97860465116279 -0.37331419675002486
6.990697674418605 -0.6080081735915135
8.002790697674419 -0.5498151211443032
9.014883720930234 -0.7897392235088061
9.974883720930231 -0.590366838571569
10.986976744186048 -0.13468424637539833
11.98418604651163 -0.3380072005449062
13.011162790697675 -0.37394667704583107
14.02325581395349 -0.30006324802957973
14.975813953488375 -0.2942103726768508
15.980465116279072 -0.22033180889364523
16.98511627906977 -0.22490512795562978
0.970232558139535 3.8598131750510847
1.9972093023255815 2.0717816483409552
2.9944186046511634 1.8004670623722872
3.9618604651162794 2.2718108397392234
4.973953488372094 2.314313515617398
5.971162790697675 2.283584703707308
6.998139534883721 2.242415101683371
7.995348837209301 2.154154909020142
9.007441860465116 2.0763646978690278
9.974883720930233 2.076997178164834
10.986976744186048 2.077658849858908
12.013953488372094 2.036489247834971
13.011162790697675 2.026680938016931
14.008372093023256 2.037793130290941
14.968372093023257 2.0384207453537027
16.002790697674424 2.049557263792936
16.98511627906977 2.039739223508806];

obj_y = [    0.2292
    0.1787
    0.1400
    0.1512
    0.1505
    0.1498
    0.1490
    0.1483
    0.1517
    0.1519
    0.1517
    0.1514
    0.1514
    0.1513
    0.1513
    0.1512
    0.1512] ./0.2292;

   constraint = [0.000242110659591
   0.000468422679626
   0.002135368462721
   0.000298844031013
   0.000523027123729
   0.000003935314348
   0.000015851337773
   0.000480942362222
   0.000041245434662
   0.000032429892185
   0.000012609887984
   0.000006302811204
   0.000002543409080
   0.000003714343359
   0.000000067825300
   0.000000063548298
   0.000940050873136
   0.000063840668741
   0.000380814047427
   0.001198269329136
   0.001478875669667
   0.000849204139731
   0.000381872088144
   0.000339969015197
   0.000194060093985
   0.000142682513415
   0.000088572666759
   0.000054341230219
   0.000032896099374
   0.000022779368296
   0.000014883067584
   0.000010015804673
   0.001216517410954
   0.009944091825887
   0.000453006730380
   0.001199680954422
   0.000591147956835
   0.000550053081135
   0.000263637644813
   0.000159657211548
   0.000106703985738
   0.000066622621045
   0.000041143037425
   0.000026442726260
   0.000016476486612
   0.000010656864653
   0.000006871500978
   0.000004582620696
   0.001302550479400
   0.000119970604462
   0.000004438205066
   0.000003620995786
   0.001328960844124
   0.000001572422591
   0.000001844959479
   0.000382000973529
   0.000052121953441
   0.000367988742108
   0.000436606342810
   0.000208880641048
   0.000097023189308
   0.000002787190910
   0.000000328426038
   0.000000101370077
   0.015747251122238
   0.000551622430947
   0.000313758901398
   0.000987087432868
   0.000642115715610
   0.000496292891454
   0.000338342248693
   0.000231960922591
   0.000132532322122
   0.000087612364137
   0.000055768331908
   0.000033721123589
   0.000020285508481
   0.000013190736602
   0.000008609257762
   0.000005820677938
   0.004213318213677
   0.001506985838977
   0.000000288859627
   0.000000236166059
   0.000355548586153
   0.000000174087709
   0.000000157839098
   0.000077331654790
   0.000006322789554
   0.000044502786373
   0.000054669955773
   0.000029790625645
   0.000014617577302
   0.000027901257048
   0.000018474913337
   0.000012736970140
   0.001216517410950
   0.009944091825916
   0.000453006730380
   0.001199680954420
   0.000591147956835
   0.000550053081135
   0.000263637644813
   0.000159657211548
   0.000106703985738
   0.000066622621045
   0.000041143037425
   0.000026442726260
   0.000016476486612
   0.000010656864653
   0.000006871500978
   0.000004582620696
   0.001213075418885
   0.000512361509588
   0.000014274314507
   0.000000274236898
   0.000167586614752
   0.000141883468293
   0.000006194437407
   0.000037586252395
   0.000016356295644
   0.000010388500135
   0.000001690999188
   0.000004663911742
   0.000001975568620
   0.000001800324844
   0.000000780729558
   0.000000271704799
   0.001786836669639
   0.001817855476032
   0.000005695818621
   0.000004521020341
   0.001003159835311
   0.000714104837324
   0.000383079924323
   0.000295272366995
   0.000167560120798
   0.000116097451484
   0.000077446461029
   0.000049978524576
   0.000031058482436
   0.000021373592931
   0.000014061248239
   0.000009483293079
   0.001789684490346
   0.002461189576324
   0.000211353372543
   0.000860858523981
   0.000641016196655
   0.000396563028489
   0.000242787540109
   0.000155250207547
   0.000091742615180
   0.000058495894661
   0.000036472964147
   0.000022527376430
   0.000014222446125
   0.000009117348498
   0.000005920645920
   0.000003989647872
   0.018247679379845
   0.001042026526692
   0.039180312957546
   0.000000119599523
   0.000000158068105
   0.000000090761443
   0.000000137577453
   0.000000141847295
   0.000000132429181
   0.000000132872006
   0.000000136911792
   0.000000139396185
   0.000000152453983
   0.000000169148625
   0.000000199616709
   0.000000218537092];

disp_con =    [0.000242110659591
   0.000468422679626
   0.002135368462721
  -0.000298844031013
  -0.000523027123729
  -0.000003935314348
  -0.000015851337773
  -0.000480942362222
  -0.000041245434662
  -0.000032429892185
  -0.000012609887984
  -0.000006302811204
  -0.000002543409080
  -0.000003714343359
  -0.000000067825300
  -0.000000063548298
  -0.000000063548298]*1e3;

comp_con = [0.015747251122238
   0.000551622430947
   0.000313758901398
   0.000987087432868
   0.000642115715610
   0.000496292891454
   0.000338342248693
   0.000231960922591
   0.000132532322122
   0.000087612364137
   0.000055768331908
   0.000033721123589
   0.000020285508481
   0.000013190736602
   0.000008609257762
   0.000005820677938
   0.000005820677938]*1e2;

   tension_con =[ 0.001789684490346
   0.002461189576324
   0.000211353372543
   0.000860858523981
   0.000641016196655
   0.000396563028489
   0.000242787540109
   0.000155250207547
   0.000091742615180
   0.000058495894661
   0.000036472964147
   0.000022527376430
   0.000014222446125
   0.000009117348498
   0.000005920645920
   0.000003989647872
   0.000003989647872]*1e3;

left_color = [0 0 0.4];
right_color = [0 0.4 0];
fig = figure(1);
set(fig,'defaultAxesColorOrder',[[0 0 0]; [0 0 0]]);

% Constraint

 ii = 1;
plot(1:17,xy_raw((17*(ii-1)+1):(17*(ii)) ,2),'--+','Color',left_color*0.75,'MarkerSize',4,'HandleVisibility','off')
hold on
 ii = 2;
plot(1:17,xy_raw((17*(ii-1)+1):(17*(ii)) ,2),'--+','Color',left_color*0.75,'MarkerSize',4,'HandleVisibility','off')
hold on
 ii = 3;
plot(1:17,xy_raw((17*(ii-1)+1):(17*(ii)) ,2),'--+','Color',left_color*0.75,'MarkerSize',4,'HandleVisibility','on')
hold on

plot(1:17,disp_con,':.','Color',left_color,'HandleVisibility','off') %SLSVP
hold on
plot(1:17,comp_con,':.','Color',left_color,'HandleVisibility','off') %SLSVP
hold on
plot(1:17,tension_con,':.','Color',left_color,'HandleVisibility','on') %SLSVP

hold on
ii = 4;
yyaxis right
ylabel('Std. objective')
plot(1:17, (2+xy_raw((17*(ii-1)+1):(17*(ii)) ,2) )/5.8598 ,'--x','Color', right_color*0.75,'MarkerSize',4,'HandleVisibility','on')

plot(1:17,obj_y,':s','Color', right_color,'MarkerSize',4,'HandleVisibility','on') %SLSVP

% add axis labes and legend
%axis tight
ylim([0 1])
xlim([1,17])
xlabel('Iteration')
yyaxis left
ylabel('Relative constraint fulfillment')

legend('SAP - constraints','SLSVP - constraints','SAP - objective', 'SLSVP - objective','Location','best')

% scaling
fig.Units               = 'centimeters';
fig.Position(3)         = opts.width;
fig.Position(4)         = opts.height;

% set text properties
set(fig.Children, ...
    'FontName',     'Times New Roman', ...
    'FontSize',     9);

% remove unnecessary white space
set(gca,'LooseInset',max(get(gca,'TightInset'), 0.02))

% export to png
fig.PaperPositionMode   = 'auto';
print([opts.saveFolder 'Figure9'], '-dpng', '-r600')
close